{% extends 'base.html' %}

{% block content %}

<div class="edge-margin">
    <h2>{{city.name}}</h2>

    <img src="{{ city.photo }}" style="max-width: 250px;" alt="profile image">

    <br>
    <br>
    <br>

    <button class="ui button" id="create-post">
        New Post
    </button>

        <script>
            $(function(){
                $("#create-post").click(function(){
                    $(".create-post-class").modal('show');
                    });
                    $(".create-post-class").modal({
                        closable: true
                    });
            });
        </script>

        <div class="ui modal create-post-class">
            <h2 class="ui modal-header">Make a New Post!!</h2>
            <div class="ui modal-body">
                
                <div class="edge-margin">

                    <form action="/posts/create/{{city.id}}" method="POST">
                        {% csrf_token %}
                        {{ post_form.as_p }}
                        <input type="submit" value="Post It">
                    </form>

                </div>
                
            </div>
        </div>



    <br>

    <h3>post list</h3>

    {% comment %} TODO copied from profile page -- make this a modal / partial {% endcomment %}
    {% for post in posts %}
        <a href="/posts/{{ post.id }}">
            <div class="ui link card">
                <div class="content">
                    <div class="header">{{ post.title }}</div>
                    <div class="meta">
                        <span class="category">{{ post.city.name }}</span>
                    </div>
                </div>
                <div class="extra content">
                    <a href="/posts/edit/{{post.id}}">
                        <button class="ui button">
                        Edit
                        </button>
                    </a>

                    <button class="ui button" id="delete-post-{{post.id}}">
                    Delete
                    </button>

                        <script>
                            $(function(){
                                $("#delete-post-{{post.id}}").click(function(){
                                    $(".delete{{post.id}}").modal('show');
                                    });
                                    $(".delete{{post.id}}").modal({
                                        closable: true
                                    });
                            });
                        </script>

                        <div class="ui modal delete{{post.id}}">
                            <h2 class="ui modal-header">Sure you want to delete post title {{post.title}}??</h2>
                            <div class="ui modal-body">
                                <a href="/posts/delete/{{post.id}}/{{city.id}}">
                                    <button class="ui button">
                                    Yes Delete It
                                    </button>
                                </a>
                            </div>
                        </div>

                </div>
            </div>
        </a>
        <br>
    {% endfor %}

</div>




{% endblock %}

<script>
    $(function(){
        $("#delete-post-{{post.id}}").click(function(){
            $(".delete{{post.id}}").modal('show');
            });
            $(".delete{{post.id}}").modal({
                closable: true
            });
    });
</script>

<div class="ui modal delete{{post.id}}">
    <h2 class="ui modal-header">Sure you want to delete post title {{post.title}}??</h2>
    <div class="ui modal-body">
        <a href="/posts/delete/{{post.id}}/{{city.id}}">
            <button class="ui button">
            Delete
            </button>
        </a>
    </div>
</div>

